<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Report Bug</title>
    <link rel="stylesheet" href="./css/report.css" />
    <link
      href="./assets/images/Palorant3.png"
      rel="shortcut icon"
      class="website-logo"
    />
  </head>
  <body>
    <div class="popup-overlay" id="popupOverlay">
      <div class="popup-container">
        <div class="popup-content">
          <div class="popup-icon">âœ“</div>
          <h2 class="popup-title">Report Submitted!</h2>
          <p class="popup-message">
            Thank you for helping us improve Palorant. We'll review your report
            soon.
          </p>
          <button class="popup-close-btn" id="popupCloseBtn">OK</button>
        </div>
      </div>
    </div>

    <div class="navbar-container">
      <div class="container">
        <div class="navbar-content">
          <div class="logo-palorant">
            <img
              src="./assets/images/Palo2.png"
              class="image-palorant"
              alt="Logo"
            />
          </div>
          <div class="nav-links">
            <a href="./index.html" class="link">Home</a>
            <a href="./agents.html" class="link">Agents</a>
            <a href="./maps.html" class="link">Maps</a>
            <a href="./news.html" class="link">News</a>
            <a href="report.html" class="link active">Report</a>
          </div>
        </div>
      </div>
    </div>

    <div class="report-container">
      <div class="report-card">
        <h1 class="report-title">Report a Bug</h1>
        <form id="bugReportForm">
          <div class="form-group">
            <label for="username" class="required-label">Username</label>
            <input
              type="text"
              id="username"
              name="username"
              placeholder="Enter your in-game username"
            />
            <div class="error-message" id="usernameError"></div>
          </div>

          <div class="form-group">
            <label for="email" class="required-label">Email</label>
            <input
              type="email"
              id="email"
              name="email"
              placeholder="Enter your email"
            />
            <div class="error-message" id="emailError"></div>
          </div>

          <div class="form-group">
            <label for="server" class="required-label">Server</label>
            <select id="server" name="server">
              <option value="" disabled selected>--Select Server--</option>
              <option value="na">North America</option>
              <option value="eu">Europe</option>
              <option value="ap">Asia Pacific</option>
              <option value="kr">Korea</option>
              <option value="latam">Latin America</option>
            </select>
            <div class="server-status" id="serverStatus"></div>
            <div class="error-message" id="serverError"></div>
          </div>

          <div class="form-group">
            <label for="bugType" class="required-label">Bug Type</label>
            <select id="bugType" name="bugType">
              <option value="" disabled selected>--Select Bug Type--</option>
              <option value="gameplay">Gameplay</option>
              <option value="ui">UI/Visual</option>
              <option value="performance">Performance</option>
              <option value="crash">Game Crash</option>
              <option value="network">Network/Connection</option>
              <option value="sound">Sound/Audio</option>
              <option value="other">Other</option>
            </select>
            <div class="error-message" id="bugTypeError"></div>
          </div>

          <div class="form-group">
            <label for="description" class="required-label">Description</label>
            <textarea
              id="description"
              name="description"
              placeholder="Please provide as much detail as possible about the bug. Include steps to reproduce, when it occurred, and how it affects gameplay."
            ></textarea>
            <div class="error-message" id="descriptionError"></div>
          </div>

          <div class="form-group">
            <label for="reproducibility" class="required-label"
              >How often does this bug occur?</label
            >
            <select id="reproducibility" name="reproducibility">
              <option value="" disabled selected>--Select Frequency--</option>
              <option value="always">Always (100% of the time)</option>
              <option value="often">
                Often (approximately 75% of the time)
              </option>
              <option value="sometimes">
                Sometimes (approximately 50% of the time)
              </option>
              <option value="rarely">
                Rarely (approximately 25% of the time)
              </option>
              <option value="once">Only happened once</option>
            </select>
            <div class="error-message" id="reproducibilityError"></div>
          </div>

          <div class="checkbox-group">
            <input type="checkbox" id="consent" name="consent" />
            <label for="consent" class="required-label">
              I give permission for the Palorant team to contact me for
              additional information regarding this bug report.
            </label>
            <div class="error-message" id="consentError"></div>
          </div>

          <button type="submit" class="submit-btn" id="submitBtn">
            Submit Report
          </button>
        </form>
      </div>
    </div>

    <section class="cta-section">
      <footer class="footer-palorant">
        <div class="footer-container">
          <div class="footer-top">
            <img
              src="./assets/images/giotWhite-01.png"
              alt="Palorant Logo"
              class="footer-logo"
            />
            <nav class="footer-nav">
              <a href="#">Privacy Policy</a>
              <a href="#">Terms of Service</a>
              <a href="#">About Us</a>
              <a href="#">Contact Us</a>
              <a href="#">Help Center</a>
            </nav>
          </div>

          <div class="footer-socials footer-socials active">
            <a href="#"
              ><img src="./assets/images/Facebook (2).png" alt="Facebook"
            /></a>
            <a href="#"
              ><img src="./assets/images/Instagram.png" alt="Instagram"
            /></a>
            <a href="#"
              ><img src="./assets/images/Youtube.png" alt="YouTube"
            /></a>
          </div>

          <div class="footer-bottom active">
            <p>&copy; 2025 Palorant. All rights reserved.</p>
            <p>Fan-made project inspired by Palorant universe.</p>
          </div>
        </div>
      </footer>
    </section>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const form = document.getElementById("bugReportForm");
        const popupOverlay = document.getElementById("popupOverlay");
        const popupCloseBtn = document.getElementById("popupCloseBtn");
        const submitBtn = document.getElementById("submitBtn");

        // Form elements
        const username = document.getElementById("username");
        const email = document.getElementById("email");
        const server = document.getElementById("server");
        const bugType = document.getElementById("bugType");
        const description = document.getElementById("description");
        const reproducibility = document.getElementById("reproducibility");
        const consent = document.getElementById("consent");

        // Error elements
        const usernameError = document.getElementById("usernameError");
        const emailError = document.getElementById("emailError");
        const serverError = document.getElementById("serverError");
        const bugTypeError = document.getElementById("bugTypeError");
        const descriptionError = document.getElementById("descriptionError");
        const reproducibilityError = document.getElementById(
          "reproducibilityError"
        );
        const consentError = document.getElementById("consentError");

        // Server status indicator
        const serverStatus = document.getElementById("serverStatus");

        // Update server status when server is selected
        server.addEventListener("change", function () {
          const selectedServer = this.value;
          let statusHTML = "";

          if (selectedServer) {
            // Simulate different server statuses (in a real app this would come from API)
            const statuses = {
              na: { status: "online", text: "Online" },
              eu: { status: "online", text: "Online" },
              ap: { status: "maintenance", text: "Maintenance" },
              kr: { status: "online", text: "Online" },
              latam: { status: "offline", text: "Connection Issues" },
            };

            const serverInfo = statuses[selectedServer];
            statusHTML = `
              <div class="status-dot status-${serverInfo.status}"></div>
              <span class="status-text">${serverInfo.text}</span>
            `;
          }

          serverStatus.innerHTML = statusHTML;
        });

        // Validation functions
        function validateUsername(value) {
          if (!value) {
            return "Username is required";
          }
          if (value.length < 3 || value.length > 16) {
            return "Username must be between 3 and 16 characters";
          }
          // Only allow alphanumeric characters and underscores
          if (!/^[a-zA-Z0-9_]+$/.test(value)) {
            return "Username can only contain letters, numbers, and underscores";
          }
          return "";
        }

        function validateEmail(value) {
          if (!value) {
            return "Email is required";
          }
          // Basic email validation
          const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          if (!emailRegex.test(value)) {
            return "Please enter a valid email address";
          }
          return "";
        }

        function validateServer(value) {
          if (!value) {
            return "Please select a server";
          }
          return "";
        }

        function validateBugType(value) {
          if (!value) {
            return "Please select a bug type";
          }
          return "";
        }

        function validateDescription(value) {
          if (!value) {
            return "Description is required";
          }
          if (value.length < 20) {
            return "Please provide a more detailed description (at least 20 characters)";
          }
          return "";
        }

        function validateReproducibility(value) {
          if (!value) {
            return "Please select how often the bug occurs";
          }
          return "";
        }

        function validateConsent(checked) {
          if (!checked) {
            return "You must give consent to submit the report";
          }
          return "";
        }

        // Validation event handlers
        username.addEventListener("blur", function () {
          const error = validateUsername(this.value.trim());
          showError(this, usernameError, error);
        });

        email.addEventListener("blur", function () {
          const error = validateEmail(this.value.trim());
          showError(this, emailError, error);
        });

        server.addEventListener("change", function () {
          const error = validateServer(this.value);
          showError(this, serverError, error);
        });

        bugType.addEventListener("change", function () {
          const error = validateBugType(this.value);
          showError(this, bugTypeError, error);
        });

        description.addEventListener("blur", function () {
          const error = validateDescription(this.value.trim());
          showError(this, descriptionError, error);
        });

        reproducibility.addEventListener("change", function () {
          const error = validateReproducibility(this.value);
          showError(this, reproducibilityError, error);
        });

        consent.addEventListener("change", function () {
          const error = validateConsent(this.checked);
          showError(this, consentError, error);
        });

        // Helper function to show errors
        function showError(input, errorElement, errorMessage) {
          if (errorMessage) {
            input.classList.add("invalid");
            errorElement.textContent = errorMessage;
            errorElement.classList.add("error-visible");
            return false;
          } else {
            input.classList.remove("invalid");
            errorElement.textContent = "";
            errorElement.classList.remove("error-visible");
            return true;
          }
        }

        // Form submission
        form.addEventListener("submit", function (e) {
          e.preventDefault();

          // Validate all fields
          const usernameValid = showError(
            username,
            usernameError,
            validateUsername(username.value.trim())
          );
          const emailValid = showError(
            email,
            emailError,
            validateEmail(email.value.trim())
          );
          const serverValid = showError(
            server,
            serverError,
            validateServer(server.value)
          );
          const bugTypeValid = showError(
            bugType,
            bugTypeError,
            validateBugType(bugType.value)
          );
          const descriptionValid = showError(
            description,
            descriptionError,
            validateDescription(description.value.trim())
          );
          const reproducibilityValid = showError(
            reproducibility,
            reproducibilityError,
            validateReproducibility(reproducibility.value)
          );
          const consentValid = showError(
            consent,
            consentError,
            validateConsent(consent.checked)
          );

          // Check if all validations passed
          if (
            usernameValid &&
            emailValid &&
            serverValid &&
            bugTypeValid &&
            descriptionValid &&
            reproducibilityValid &&
            consentValid
          ) {
            // Disable submit button to prevent multiple submissions
            submitBtn.disabled = true;
            submitBtn.textContent = "Submitting...";

            // Simulate form submission (in a real app, this would be an AJAX request)
            setTimeout(() => {
              // Show success popup
              popupOverlay.classList.add("active");

              // Reset form
              form.reset();
              serverStatus.innerHTML = "";

              // Re-enable submit button
              submitBtn.disabled = false;
              submitBtn.textContent = "Submit Report";
            }, 1000);
          } else {
            // Scroll to the first error
            const firstError = document.querySelector(".error-visible");
            if (firstError) {
              firstError.scrollIntoView({
                behavior: "smooth",
                block: "center",
              });
            }
          }
        });

        // Real-time validation
        const formInputs = form.querySelectorAll("input, select, textarea");
        formInputs.forEach((input) => {
          input.addEventListener("input", function () {
            // Remove error styling as user types
            if (input.classList.contains("invalid")) {
              input.classList.remove("invalid");
              const errorId = input.id + "Error";
              const errorElement = document.getElementById(errorId);
              if (errorElement) {
                errorElement.textContent = "";
                errorElement.classList.remove("error-visible");
              }
            }
          });
        });

        // Close popup
        popupCloseBtn.addEventListener("click", () => {
          popupOverlay.classList.remove("active");
        });
      });
    </script>
  </body>
</html>
